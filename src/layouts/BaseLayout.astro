---
import { ViewTransitions } from 'astro:transitions';

interface Props {
  title: string;
  description?: string;
}

const { title, description = 'Home Asset & Service Tracker' } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <title>{title} | Asset Tracker</title>
    <!-- Enable View Transitions for SPA-like navigation -->
    <ViewTransitions />
  </head>
  <body class="bg-surface-50 text-surface-900 font-sans antialiased">
    <!-- Loading indicator -->
    <div id="loading-bar" class="fixed top-0 left-0 right-0 h-1 bg-primary-500 z-[100] transform -translate-x-full transition-transform duration-300"></div>
    
    <slot />
    
    <script>
      // Loading bar animation
      const loadingBar = document.getElementById('loading-bar');
      
      document.addEventListener('astro:before-preparation', () => {
        if (loadingBar) {
          loadingBar.style.transform = 'translateX(-50%)';
        }
      });
      
      document.addEventListener('astro:after-preparation', () => {
        if (loadingBar) {
          loadingBar.style.transform = 'translateX(-20%)';
        }
      });
      
      document.addEventListener('astro:before-swap', () => {
        if (loadingBar) {
          loadingBar.style.transform = 'translateX(0%)';
        }
      });
      
      document.addEventListener('astro:after-swap', () => {
        if (loadingBar) {
          setTimeout(() => {
            loadingBar.style.transform = 'translateX(-100%)';
          }, 100);
        }
      });
      
      // Reset on page load
      document.addEventListener('astro:page-load', () => {
        const bar = document.getElementById('loading-bar');
        if (bar) {
          bar.style.transform = 'translateX(-100%)';
        }
      });
    </script>
  </body>
</html>

<style is:global>
  * {
    box-sizing: border-box;
  }
  
  html {
    scroll-behavior: smooth;
  }
  
  body {
    min-height: 100vh;
  }
  
  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  ::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: #a1a1a1;
  }
  
  /* View Transition Animations - faster */
  ::view-transition-old(root) {
    animation: fade-out 0.15s ease-out forwards;
  }
  
  ::view-transition-new(root) {
    animation: fade-in 0.15s ease-out forwards;
  }
  
  @keyframes fade-out {
    from { opacity: 1; }
    to { opacity: 0; }
  }
  
  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  /* Loading bar glow effect */
  #loading-bar {
    box-shadow: 0 0 10px rgba(14, 165, 233, 0.5);
  }
</style>
